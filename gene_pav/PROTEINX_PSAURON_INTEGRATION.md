# PROTEINX and PSAURON Integration Status

## Overview
The plotting pipeline is fully configured to use PROTEINX and PSAURON data once those files are generated by `pavprot.py`.

## Files Modified

### 1. `run_pavprot.sh` ✅
**Changes:** Uncommented and enabled lines 32-33 to pass PROTEINX and PSAURON output paths to pavprot.py

```bash
--proteinx-out "$DATA_DIR/output/proteinx/GCF_013085055.1_proteinx.tsv,$DATA_DIR/output/proteinx/Foc47_013085055.1_proteinx.tsv" \
--psauron-out "$DATA_DIR/output/psauron/ref_all.csv,$DATA_DIR/output/psauron/qry_all.csv"
```

**Output Locations:**
- ProteinX: `/Users/sadik/Documents/projects/FungiDB/foc47/output/proteinx/`
- Psauron: `/Users/sadik/Documents/projects/FungiDB/foc47/output/psauron/`

## Configuration in Plotting Pipeline

### `run_pipeline.py` CONFIG Dictionary
**Status:** Already configured ✅

```python
CONFIG = {
    # External data files (optional - tasks will skip if not found)
    "psauron_ref": Path("/Users/sadik/Documents/projects/FungiDB/foc47/output/psauron/ref_all.csv"),
    "psauron_qry": Path("/Users/sadik/Documents/projects/FungiDB/foc47/output/psauron/qry_all.csv"),
    "proteinx_ref": Path("/Users/sadik/Documents/projects/FungiDB/foc47/output/proteinx/GCF_013085055.1_proteinx.tsv"),
    "proteinx_qry": Path("/Users/sadik/Documents/projects/FungiDB/foc47/output/proteinx/Foc47_013085055.1_proteinx.tsv"),
}
```

## Task Status and Expected Output

### Task_5: ProteinX Variants (3 figures)
**Status:** Ready to generate ✅
**Data Source:** proteinx_ref, proteinx_qry
**Expected Output:**
- `proteinx_by_mapping_type.png` - pLDDT distribution by mapping type
- `proteinx_by_class_type.png` - pLDDT distribution by class type
- `proteinx_by_mapping_and_class.png` - pLDDT by mapping and class combined

### Task_6: Psauron Integration (5 figures)
**Status:** Ready to generate ✅
**Data Source:** psauron_ref, psauron_qry, enriched gene/transcript data
**Expected Output:**
- `psauron_comparison.png` - Reference/query comparison
- `psauron_comparison_all.png` - All class types
- `psauron_comparison_emckmnje1.png` - Specific class type comparison
- `psauron_by_mapping_type.png` - Psauron by mapping type
- `psauron_by_class_type.png` - Psauron by class type

### Task_7: Psauron vs pLDDT (4 figures)
**Status:** Ready to generate ✅
**Data Source:** psauron files + proteinx files
**Expected Output:**
- `psauron_vs_plddt_gene_level.png`
- `psauron_vs_plddt_by_class_gene_level.png`
- `psauron_vs_plddt_by_mapping_gene_level.png`
- `psauron_vs_plddt_by_mapping_and_class_gene_level.png`

## Workflow to Generate All 22 Figures

### Step 1: Generate ProteinX and Psauron Data
```bash
cd ~/projects/github_prj/uolismib/gene_pav
./run_pavprot.sh
```

This will:
- Run PAVprot analysis pipeline
- Output files to:
  - `/Users/sadik/Documents/projects/FungiDB/foc47/output/proteinx/`
  - `/Users/sadik/Documents/projects/FungiDB/foc47/output/psauron/`

### Step 2: Generate All Plotting Tasks
```bash
cd ~/projects/github_prj/uolismib/gene_pav/project_scripts
python run_pipeline.py
```

This will generate all 22 figures:
- 10 figures already completed ✅ (Groups 1-3, 7)
- 3 ProteinX variant figures (Task_5)
- 5 Psauron comparison figures (Task_6)
- 4 Psauron vs pLDDT figures (Task_7)

### Output Location
All figures will be saved to:
```
~/projects/github_prj/uolismib/gene_pav/plot_out/refactored/
```

## File Format Specifications

### ProteinX Files (tab-separated)
Expected columns:
- `gene_name` - Transcript identifier (with optional _sample_N suffix)
- `residue_plddt_mean` - Mean pLDDT score (0-100 scale)
- Other columns as generated by AlphaFold

### Psauron Files (CSV, skip 2 header rows)
Expected columns (after rename):
- `{ref,qry}_gene` - Gene identifier
- `{ref,qry}_psauron_score_mean` - Mean psauron score (0-1 scale)
- `{ref,qry}_psauron_is_protein` - Boolean protein flag

## Error Handling
The pipeline includes robust error handling:
- Tasks skip gracefully if input files are not found
- Missing data points are logged
- Partial results can still be generated if some data is available

## Next Steps
1. Ensure `/Users/sadik/Documents/projects/FungiDB/foc47/output/proteinx/` directory exists
2. Ensure `/Users/sadik/Documents/projects/FungiDB/foc47/output/psauron/` directory exists
3. Run `./run_pavprot.sh` to generate data files
4. Run `python project_scripts/run_pipeline.py` to generate all plots
5. Verify 22 PNG files appear in `plot_out/refactored/`

## Summary
✅ All integration points are configured
✅ Paths are correctly set in both `run_pavprot.sh` and `run_pipeline.py`
✅ Pipeline code is ready to process ProteinX and Psauron data
✅ Only remaining step: Generate the data files via `./run_pavprot.sh`
